<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AR Car Demo</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@2.2.2/aframe/build/aframe-ar.min.js"></script>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        Loading AR Experience... Please allow camera access
    </div>

    <a-scene 
        embedded 
        arjs="sourceType: webcam; 
               debugUIEnabled: false; 
               detectionMode: mono; 
               trackingMethod: best;"
        vr-mode-ui="enabled: false"
    >
        <!-- Asset Management -->
        <a-assets timeout="10000">
            <a-asset-item id="car-model" src="https://raw.githubusercontent.com/TKvdM/webar_jdm_cube/main/assets/scene.glb"></a-asset-item>
        </a-assets>

        <!-- Marker -->
        <a-marker preset="hiro">
            <a-entity 
                gltf-model="#car-model"
                position="0 0 0"
                rotation="0 0 0"
                scale="0.5 0.5 0.5"
                animation__rotate="property: rotation; 
                                   to: 0 360 0; 
                                   loop: true; 
                                   dur: 10000"
            >
            </a-entity>

            <!-- Ground Plane -->
            <a-plane 
                position="0 0 0" 
                rotation="-90 0 0" 
                width="4" 
                height="4" 
                color="#7BC8A4"
            ></a-plane>
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        window.addEventListener('load', function() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            
            // Remove loading overlay when scene is loaded
            document.querySelector('a-scene').addEventListener('loaded', function () {
                loadingOverlay.style.display = 'none';
            });

            // Log any model loading errors
            const carModel = document.querySelector('[gltf-model]');
            carModel.addEventListener('model-loaded', function() {
                console.log('Car model loaded successfully');
            });
            carModel.addEventListener('model-error', function(error) {
                console.error('Car model loading error:', error);
            });
        });
    </script>
</body>
</html>
