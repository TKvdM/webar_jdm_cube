<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAR JDM Cube</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/ar.js/1.7.2/aframe/build/aframe-ar.min.js"></script>
    <script>
        AFRAME.registerComponent('road-animation', {
            tick: function (time, timeDelta) {
                let mesh = this.el.getObject3D('mesh');
                if (mesh) {
                    mesh.material.map.offset.y -= timeDelta * 0.0005; // Moves texture downwards
                }
            }
        });
        
        function driftCar() {
            let car = document.querySelector("#car");
            car.setAttribute("animation", "property: position; to: 0 0.1 -0.5; dur: 1000; easing: easeOutQuad");
            setTimeout(() => {
                car.setAttribute("animation", "property: rotation; to: 0 180 0; dur: 500");
            }, 1000);
        }
    </script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
        <!-- Marker on the back wall of the physical cube -->
        <a-marker type="pattern" url="pattern-qr.patt">
            
            <!-- Road positioned at the bottom of the physical cube -->
            <a-plane id="road" width="1" height="2" position="0 -0.25 0" rotation="-90 0 0" material="src: assets/Material.011_baseColor.png; repeat: 1 3" road-animation></a-plane>
            
            <!-- Car Model on the road -->
            <a-entity id="car" gltf-model="assets/scene.glb" position="0 -0.2 0" scale="0.1 0.1 0.1"></a-entity>
        </a-marker>
        <a-entity camera></a-entity>
    </a-scene>
    
    <button onclick="driftCar()" style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); padding: 10px 20px; font-size: 20px;">Drift</button>
</body>
</html>
